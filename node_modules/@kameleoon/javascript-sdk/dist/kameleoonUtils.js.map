{"version":3,"file":"kameleoonUtils.js","names":["_javascriptSdkCore","require","_typeof","a","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","KameleoonUtils","_classCallCheck","b","TypeError","_defineProperties","c","d","length","enumerable","configurable","writable","_toPropertyKey","key","_createClass","_toPrimitive","toPrimitive","call","String","Number","_inherits","create","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","e","Reflect","construct","arguments","apply","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","KameleoonUtilsConstructor","getVisitorCode","domain","defaultVisitorCode","cookie","document","visitorCodeResult","getCookieVisitorCode","ok","data","visitorCode","generateRandomString","VISITOR_CODE_LENGTH","resultCookie","getResultCookie","split","Cookie","PairsDelimiter","forEach","item","KameleoonCoreUtils","kameleoonUtilsConstructor"],"sources":["../src/kameleoonUtils.ts"],"sourcesContent":["import {\n  Cookie,\n  KameleoonCoreUtils,\n  VISITOR_CODE_LENGTH,\n  ClientGetVisitorCodeParametersType,\n} from '@kameleoon/javascript-sdk-core';\n\n// --- Note ---\n// Extra class is created:\n// - To enforce abstract `getVisitorCode` method\n// - To use extended methods while `KameleoonUtils` itself only operates on static methods\n// - To keep similar parameters object on inner implementation and disperse it for proprietary implementations\nclass KameleoonUtilsConstructor extends KameleoonCoreUtils {\n  public getVisitorCode({\n    domain,\n    defaultVisitorCode,\n  }: ClientGetVisitorCodeParametersType): string {\n    const cookie = document.cookie;\n\n    const visitorCodeResult = this.getCookieVisitorCode(cookie);\n\n    if (visitorCodeResult.ok && visitorCodeResult.data) {\n      return visitorCodeResult.data;\n    }\n\n    const visitorCode =\n      defaultVisitorCode || this.generateRandomString(VISITOR_CODE_LENGTH);\n\n    const resultCookie = this.getResultCookie({ domain, visitorCode });\n\n    // --- Note ---\n    // - Browser automatically adds new cookie in the end (without overwrite)\n    // - Only one key-value pair can be added at a time\n    resultCookie.split(Cookie.PairsDelimiter).forEach((item) => {\n      document.cookie = item;\n    });\n\n    return visitorCode;\n  }\n}\n\n/**\n * @class\n * KameleoonUtils - a class with containing a number of static helper methods\n * */\nexport class KameleoonUtils {\n  /**\n   * @method getVisitorCode obtains visitor code from the browser cookie, if the visitor code doesn't yet exist generates a random visitor code (or uses a provided default) and sets a new visitor code to cookie\n   * @param {string} domain domain which cookie belongs to\n   * @param {string | undefined} defaultVisitorCode visitor code to be used in case there is no visitor code in cookies Note: if not passed visitor code will be randomly generated\n   * @returns {string} result visitor code\n   * */\n  static getVisitorCode(domain: string, defaultVisitorCode?: string): string {\n    const kameleoonUtilsConstructor = new KameleoonUtilsConstructor();\n\n    return kameleoonUtilsConstructor.getVisitorCode({\n      domain,\n      defaultVisitorCode,\n    });\n  }\n}\n"],"mappings":"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"}