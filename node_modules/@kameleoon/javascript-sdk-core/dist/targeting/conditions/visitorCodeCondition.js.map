{"version":3,"file":"visitorCodeCondition.js","names":["VisitorCodeCondition","a","b","visitorCode","matchType","_classCallCheck","_defineProperty","conditionValue","_createClass","key","value","evaluate","Ok","checkCondition","MatchType","CONTAINS","includes","EXACT","REGULAR_EXPRESSION","Utilities","parseRegExp","test","exhaustCheck","exports"],"sources":["../../../src/targeting/conditions/visitorCodeCondition.ts"],"sourcesContent":["import { Ok, Result } from 'ts-res';\nimport { exhaustCheck, KameleoonError } from 'src/kameleoonError';\nimport { Utilities } from 'src/utilities';\nimport { EvaluationDataType, MatchType } from 'src/targeting/types';\nimport { ConditionDataType, ICondition } from './types';\n\nexport class VisitorCodeCondition implements ICondition {\n  private matchType?: MatchType | null;\n  private conditionValue?: string | null;\n\n  constructor({ visitorCode, matchType }: ConditionDataType) {\n    this.matchType = matchType;\n    this.conditionValue = visitorCode;\n  }\n\n  public evaluate({\n    visitorCode,\n  }: EvaluationDataType): Result<boolean, KameleoonError> {\n    return Ok(this.checkCondition(visitorCode));\n  }\n\n  private checkCondition(visitorCode: string): boolean {\n    if (!this.matchType || !this.conditionValue) {\n      return false;\n    }\n\n    switch (this.matchType) {\n      case MatchType.CONTAINS:\n        return visitorCode.includes(this.conditionValue);\n      case MatchType.EXACT:\n        return visitorCode === this.conditionValue;\n      case MatchType.REGULAR_EXPRESSION:\n        return Utilities.parseRegExp(this.conditionValue).test(visitorCode);\n      default:\n        exhaustCheck(this.matchType);\n    }\n  }\n}\n"],"mappings":"k+CAMa,CAAAA,oBAAoB,yBAI/B,SAAAC,EAAAC,CAAA,CAA2D,IAA7C,CAAAC,CAAW,CAAAD,CAAA,CAAXC,WAAW,CAAEC,CAAS,CAAAF,CAAA,CAATE,SAAS,CAAAC,eAAA,MAAAJ,CAAA,EAAAK,eAAA,0BAAAA,eAAA,+BAClC,IAAI,CAACF,SAAS,CAAGA,CAAS,CAC1B,IAAI,CAACG,cAAc,CAAGJ,CACxB,CAAC,OAAAK,YAAA,CAAAP,CAAA,GAAAQ,GAAA,YAAAC,KAAA,CAED,SAAAC,SAAAV,CAAA,CAEwD,IADtD,CAAAE,CAAW,CAAAF,CAAA,CAAXE,WAAW,CAEX,MAAO,GAAAS,SAAE,EAAC,IAAI,CAACC,cAAc,CAACV,CAAW,CAAC,CAC5C,CAAC,GAAAM,GAAA,kBAAAC,KAAA,CAED,SAAAG,eAAuBV,CAAmB,CAAW,CACnD,GAAI,CAAC,IAAI,CAACC,SAAS,EAAI,CAAC,IAAI,CAACG,cAAc,CACzC,SAGF,OAAQ,IAAI,CAACH,SAAS,EACpB,IAAK,CAAAU,gBAAS,CAACC,QAAQ,CACrB,MAAO,CAAAZ,CAAW,CAACa,QAAQ,CAAC,IAAI,CAACT,cAAc,CAAC,CAClD,IAAK,CAAAO,gBAAS,CAACG,KAAK,CAClB,MAAO,CAAAd,CAAW,GAAK,IAAI,CAACI,cAAc,CAC5C,IAAK,CAAAO,gBAAS,CAACI,kBAAkB,CAC/B,MAAO,CAAAC,oBAAS,CAACC,WAAW,CAAC,IAAI,CAACb,cAAc,CAAC,CAACc,IAAI,CAAClB,CAAW,CAAC,CACrE,QACE,GAAAmB,4BAAY,EAAC,IAAI,CAAClB,SAAS,CAAC,CAAC,CAEnC,CAAC,IAAAH,CAAA,IAAAsB,OAAA,CAAAvB,oBAAA,CAAAA,oBAAA"}