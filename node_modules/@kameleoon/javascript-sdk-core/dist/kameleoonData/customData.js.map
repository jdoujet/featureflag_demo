{"version":3,"file":"customData.js","names":["CustomData","a","index","_classCallCheck","_defineProperty","c","arguments","length","value","Array","e","nonce","Utilities","getNonce","_createClass","key","get","uniqueValues","_toConsumableArray","Set","resultValue","forEach","Object","keys","UrlEventType","UrlParameter","Index","ValuesCountMap","encodeURIComponent","JSON","stringify","Overwrite","Nonce","type","KameleoonData","exports"],"sources":["../../src/kameleoonData/customData.ts"],"sourcesContent":["import { UrlEventType, UrlParameter } from 'src/requester';\nimport { Utilities } from 'src/utilities';\nimport { CustomDataType, IKameleoonData, KameleoonData } from './types';\n\n/**\n * @class\n * CustomData - a class for creating an instance for user's custom data\n * */\nexport class CustomData implements IKameleoonData {\n  private index: number;\n  private value: string[];\n  private nonce: string;\n\n  /**\n   * @param {number} index - an index of custom data to be stored under in a state, an index of custom data can be specified in `Advanced Tools` section of Kameleoon Application\n   * @param {string[]} value - custom value to store under the specified id, value can be anything but has to be stringified to match the `string` type. *Note* value is variadic parameter and can be used as follows\n   * @example\n   * ```ts\n   * // - Single value\n   * const customData = new CustomData(0, 'value_1');\n   * // - Variadic number of values\n   * const customData = new CustomData(0, 'value_1', 'value_2', 'value_3');\n   * // - Array of values\n   * const values = ['value_1', 'value_2', 'value_3'];\n   * const customData = new CustomData(0, ...values);\n   * ```\n   * */\n  constructor(index: number, ...value: string[]) {\n    this.index = index;\n    this.value = value;\n    this.nonce = Utilities.getNonce();\n  }\n\n  /**\n   * @property url - url for the current data type used for events tracking\n   * */\n  get url(): string {\n    // --- Note ---\n    // If SDK is used in vanilla JS codebase, then you're also able to create an instance\n    // with no required data, we don't want send anything to tracking in that case\n    if (typeof this.index !== 'number') {\n      return '';\n    }\n\n    const uniqueValues = [...new Set(this.value)];\n    let resultValue: Record<string, 1> = {};\n\n    // --- Note ---\n    // Final value should look like this `{ \"value_1\": 1, \"value_2\": 1, \"value_3\": 1}`\n    // With no duplicates\n    uniqueValues.forEach((value) => {\n      resultValue[value] = 1;\n    });\n\n    if (!Object.keys(resultValue).length) {\n      return '';\n    }\n\n    return (\n      UrlEventType.CustomData +\n      UrlParameter.Index +\n      this.index +\n      UrlParameter.ValuesCountMap +\n      encodeURIComponent(JSON.stringify(resultValue)) +\n      UrlParameter.Overwrite +\n      String(true) +\n      UrlParameter.Nonce +\n      this.nonce\n    );\n  }\n\n  /**\n   * @property data - data of the current class instance\n   * */\n  get data(): CustomDataType {\n    return {\n      index: this.index,\n      value: this.value,\n      type: KameleoonData.CustomData,\n      nonce: this.nonce,\n    };\n  }\n}\n"],"mappings":"04EAIA;AACA;AACA;AACA,KAHA,GAIa,CAAAA,UAAU,yBAKrB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OACE,SAAAC,EAAYC,CAAa,CAAsB,CAAAC,eAAA,MAAAF,CAAA,EAAAG,eAAA,sBAAAA,eAAA,sBAAAA,eAAA,sBAC7C,IAAI,CAACF,KAAK,CAAGA,CAAK,SAAAG,CAAA,CAAAC,SAAA,CAAAC,MAAA,CADUC,CAAK,CAAAC,KAAA,GAAAJ,CAAA,CAAAA,CAAA,MAAAK,CAAA,GAAAA,CAAA,CAAAL,CAAA,CAAAK,CAAA,GAALF,CAAK,CAAAE,CAAA,IAAAJ,SAAA,CAAAI,CAAA,EAEjC,IAAI,CAACF,KAAK,CAAGA,CAAK,CAClB,IAAI,CAACG,KAAK,CAAGC,oBAAS,CAACC,QAAQ,EACjC,CAEA;AACF;AACA,OAFE,OAAAC,YAAA,CAAAb,CAAA,GAAAc,GAAA,OAAAC,GAAA,CAGA,SAAAA,IAAA,CAAkB,CAChB;AACA;AACA;AACA,GAA0B,QAAQ,EAA9B,MAAO,KAAI,CAACd,KAAkB,CAChC,MAAO,EAAE,CACV,GAEK,CAAAe,CAAY,CAAAC,kBAAA,CAAO,GAAI,CAAAC,GAAG,CAAC,IAAI,CAACX,KAAK,CAAC,CAAC,CACzCY,CAA8B,CAAG,CAAC,CAAC,OAKvC,CAAAH,CAAY,CAACI,OAAO,CAAC,SAACb,CAAK,CAAK,CAC9BY,CAAW,CAACZ,CAAK,CAAC,CAAG,CACvB,CAAC,CAAC,CAEGc,MAAM,CAACC,IAAI,CAACH,CAAW,CAAC,CAACb,MAAM,CAKlCiB,uBAAY,CAACxB,UAAU,CACvByB,uBAAY,CAACC,KAAK,CAClB,IAAI,CAACxB,KAAK,CACVuB,uBAAY,CAACE,cAAc,CAC3BC,kBAAkB,CAACC,IAAI,CAACC,SAAS,CAACV,CAAW,CAAC,CAAC,CAC/CK,uBAAY,CAACM,SAAS,OACV,CACZN,uBAAY,CAACO,KAAK,CAClB,IAAI,CAACrB,KAAK,CAZH,EAcX,CAEA;AACF;AACA,OAFE,GAAAI,GAAA,QAAAC,GAAA,CAGA,SAAAA,IAAA,CAA2B,CACzB,MAAO,CACLd,KAAK,CAAE,IAAI,CAACA,KAAK,CACjBM,KAAK,CAAE,IAAI,CAACA,KAAK,CACjByB,IAAI,CAAEC,oBAAa,CAAClC,UAAU,CAC9BW,KAAK,CAAE,IAAI,CAACA,KACd,CACF,CAAC,IAAAV,CAAA,IAAAkC,OAAA,CAAAnC,UAAA,CAAAA,UAAA"}