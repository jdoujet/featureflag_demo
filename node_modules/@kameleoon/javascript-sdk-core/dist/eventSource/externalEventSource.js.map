{"version":3,"file":"externalEventSource.js","names":["ExternalEventSource","a","siteCode","externalEventSource","_classCallCheck","_defineProperty","url","URL","SERVER_SENT_EVENTS","UrlQuery","Sse","eventSource","initialize","_createClass","key","value","open","onEvent","eventType","REAL_TIME_EVENT","close","exports"],"sources":["../../src/eventSource/externalEventSource.ts"],"sourcesContent":["import { URL } from 'src/requester';\nimport { UrlQuery } from 'src/requester/constants';\nimport { REAL_TIME_EVENT } from './constants';\nimport { IExternalEventSource, IExternalEventSourceConstructor } from './types';\n\nexport interface IEventSource {\n  open: (onEvent: (timestamp: number) => void) => void;\n  close: () => void;\n}\n\nexport class ExternalEventSource implements IEventSource {\n  private eventSource: IExternalEventSource;\n  private siteCode: string;\n\n  constructor(\n    siteCode: string,\n    externalEventSource: IExternalEventSourceConstructor,\n  ) {\n    const url = URL.SERVER_SENT_EVENTS + UrlQuery.Sse + siteCode;\n    const eventSource = externalEventSource.initialize(url);\n\n    this.eventSource = eventSource;\n    this.siteCode = siteCode;\n  }\n\n  public open(onEvent: (timestamp: number) => void): void {\n    this.eventSource.open({\n      onEvent,\n      siteCode: this.siteCode,\n      eventType: REAL_TIME_EVENT,\n    });\n  }\n\n  public close(): void {\n    this.eventSource.close();\n  }\n}\n"],"mappings":"08CAUa,CAAAA,mBAAmB,yBAI9B,SAAAC,EACEC,CAAgB,CAChBC,CAAoD,CACpD,CAAAC,eAAA,MAAAH,CAAA,EAAAI,eAAA,4BAAAA,eAAA,4BACM,CAAAC,CAAG,CAAGC,cAAG,CAACC,kBAAkB,CAAGC,mBAAQ,CAACC,GAAG,CAAGR,CAAQ,CACtDS,CAAW,CAAGR,CAAmB,CAACS,UAAU,CAACN,CAAG,CAAC,CAEvD,IAAI,CAACK,WAAW,CAAGA,CAAW,CAC9B,IAAI,CAACT,QAAQ,CAAGA,CAClB,CAAC,OAAAW,YAAA,CAAAZ,CAAA,GAAAa,GAAA,QAAAC,KAAA,CAED,SAAAC,KAAYC,CAAoC,CAAQ,CACtD,IAAI,CAACN,WAAW,CAACK,IAAI,CAAC,CACpBC,OAAO,CAAPA,CAAO,CACPf,QAAQ,CAAE,IAAI,CAACA,QAAQ,CACvBgB,SAAS,CAAEC,2BACb,CAAC,CACH,CAAC,GAAAL,GAAA,SAAAC,KAAA,CAED,SAAAK,MAAA,CAAqB,CACnB,IAAI,CAACT,WAAW,CAACS,KAAK,EACxB,CAAC,IAAAnB,CAAA,IAAAoB,OAAA,CAAArB,mBAAA,CAAAA,mBAAA"}